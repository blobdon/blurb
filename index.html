<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Author Approved</title>
  <meta name="description" content="Author Approved">
  <meta name="author" content="blobdon">

  <!-- <link rel="stylesheet" href="css/styles.css?v=1.0"> -->

</head>

<body>
    <h1 id="title"></h1>

    <!-- Incoming Reviews -->
    <div id="reviewsIn">
        <ul id="reviewsInList"></ul>
    </div>
    <br>

    <!-- Outgoing Reviews, if its an author -->
    <div id="reviewsOut">
        <ul id="reviewsOutList"></ul>
    </div>
    <script>
        var d = document;
        var pn = window.location.pathname;
        console.log(pn);
        if (pn.startsWith("/books/") || pn.startsWith("/authors/")) {
            jsonUpdate(pn);
        };
        function jsonUpdate(filepath) {
            fetch("http://localhost:8080/api"+filepath+".json")
                .then(function(response) {
                    return response.json();
                })
                .then(function(data) {
                    if (typeof data.Name !== 'undefined') {
                        d.getElementById("title").innerText = data.Name;
                    };
                    if (typeof data.BooksAuthored !== 'undefined') {
                        var inList = d.getElementById("reviewsInList")
                        for (let [i, t] of Object.entries(data.BooksAuthored)) {
                            a = d.createElement("a");
                            a.innerText = t;
                            a.href = "/books/" + i;
                            var li = d.createElement("li");
                            inList.appendChild(li).appendChild(a);
                        };
                    };
                    if (typeof data.BooksReviewed !== 'undefined') {
                        var outList = d.getElementById("reviewsOutList");
                        for (let [i, t] of Object.entries(data.BooksReviewed)) {
                            var a = d.createElement("a");
                            a.innerText = t;
                            a.href = "/books/" + i;
                            var li = d.createElement("li");
                            outList.appendChild(li).appendChild(a);
                        };
                    };
                })
                .catch(function(err) {
                    console.log(err);
            });
        }
    </script>
</body>
</html>